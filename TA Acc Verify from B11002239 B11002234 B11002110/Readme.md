# Low Power Lab 2 模型推演說明
Members: B11002239 邱彥銘；B11002234 林暄凱；B11002110 張恒豪

## 圖片預處理 (transforms.Compose Code)
將圖片裁剪至只剩中心的 16x16 部分，並做二值化處理。
```python
def binarize_input(x): # 圖片像素二值化
    return (x > 0.5).float() # e.g. x = torch.tensor([0.2, 0.7, 0.3, 0.9])
                             #      return tensor([0.0, 1.0, 0.0, 1.0])

transform = transforms.Compose([
    transforms.CenterCrop(16),
    transforms.ToTensor(), # 將圖片的儲存格式從 numpy 轉成 tensor，並將所有元素轉換為 0 到 1 間的浮點數
    transforms.Lambda(binarize_input)
])
```

## 整體規格與架構
### 資料格式
卷積層、全連接層、ReLU、max pooling **皆使用 int32 運算乘法與加法**；惟存至 memory 之前會轉成 int16 (如以下 x=x>>9 部分)。

### 注意: 每個卷積層都有加 zero padding，padding size 是 1
### 注意: 所有卷積層和全連接層都沒有 Bias

### 詳細規格與架構
```python
    def forward(self, x):

        print(f"\nModel input x.shape = {x.shape}, x = \n{x}")

        # 第一層卷積 (conv1)
        # input channel: 1
        # output channel: 4
        # kernel size: 3x3
        # zero padding size: 1
        x = conv2d_int(x, self.w1, pad=1) # x 中的元素大小範圍: [9*-128, 9*127] = [-1152, 1143]
        print(f"\nAfter \"x = conv2d_int(x, self.w1, pad=1)\", x.shape = {x.shape}, x = \n{x}")

        x = relu_int(x) # x 中的元素大小範圍: [0, 1143]
        print(f"\nAfter \"x = relu_int(x)\", x.shape = {x.shape}, x = \n{x}")

        x = maxpool_int(x, 2)
        print(f"\nAfter \"x = maxpool_int(x, 2)\", x.shape = {x.shape}, x = \n{x}")

        # 第二層卷積 (conv2)
        # input channel: 4
        # output channel: 5
        # kernel size: 3x3
        # zero padding size: 1
        x = conv2d_int(x, self.w2, pad=1) # x 中的元素大小範圍: [1143*(9*4)*-128, 1143*(9*4)*127] = [-5266944, 5225796] = [-2^22.33, 2^22.32] -> 23+1 個 bit 存 (加上去的那個 1 是 sign bit)
        print(f"\nAfter \"x = conv2d_int(x, self.w2, pad=1)\", x.shape = {x.shape}, x = \n{x}")

        x = relu_int(x)
        print(f"\nAfter \"x = relu_int(x)\", x.shape = {x.shape}, x = \n{x}")

        x = x>>9 # 右移以確保能以有號 16bit 的形式存進 Data Memory。事實上這裡移 (24-16) 個 bit 就好，但為了讓整個流程位移的 bit 數都相等，所以才移到 9 個 bit
        print(f"\nAfter \"x = x>>9\", x.shape = {x.shape}, x = \n{x}")

        x = maxpool_int(x, 8) # x 中的元素大小範圍: [-2^14, (2^14)-1] (因為剛剛右移了 9 個 bit)
        print(f"\nAfter \"x = maxpool_int(x, 8)\", x.shape = {x.shape}, x = \n{x}")

        # 將 x reshape，以送至全連接層
        x = x.reshape(-1) 
        print(f"\nAfter \"x = x.reshape(-1)\", x.shape = {x.shape}, x = \n{x}")

        # 最後用來產生預測結果的全連接層 (fc)
        # input channel: 5
        # output channel: 10
        x = np.dot(self.w3.astype(np.int32), x) # x 中的元素大小範圍: [((2^14)-1)*5*-128, (-2^14)*5*-128] = [-10485120, 10485760] = [-2^23.32, 2^23.32] -> 24+1 個 bit 存
        print(f"\nAfter \"x = np.dot(self.w3.astype(np.int32)\", x.shape = {x.shape}, x = \n{x}")

        x=x>>9 # 右移 (25-16) 個 bit 以確保能以有號 16bit 的形式存進 Data Memory
        print(f"\nAfter \"x = x>>9\", x.shape = {x.shape}, x = \n{x}")

        pred = int(np.argmax(x))
        print(f"\npredict number: {pred}")

        return x
```

### 單張圖片推演範例
```
Model input x.shape = (1, 16, 16), x =
[[[0 0 0 0 1 1 1 1 1 1 1 1 0 0 0 0]
  [0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0]
  [0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 0]
  [0 0 0 0 0 1 1 1 1 0 0 0 0 0 0 0]
  [0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0]
  [0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0]
  [0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0]
  [0 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1]
  [0 1 1 1 1 0 0 0 0 0 1 1 1 1 1 1]
  [1 1 1 1 0 0 0 1 1 1 1 1 1 1 1 1]
  [1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1]
  [1 1 1 1 0 1 1 1 1 0 0 0 0 0 1 1]
  [1 1 1 1 1 1 1 1 0 0 0 0 0 1 1 1]
  [0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
  [0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0]
  [0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 0]]]

After "x = conv2d_int(x, self.w1, pad=1)", x.shape = (4, 16, 16), x =
[[[   0    0    0  -98  -89  -88 -133 -148 -148 -148  -93   50   56    0
      0    0]
  [   0    0    0  -90  -21 -102 -138  -97  -97  -42  101  197   72    0
      0    0]
  [   0    0    0    0  -55 -288 -225  -97  -42  101  197   72    0    0
      0    0]
  [   0    0    0  -55 -198 -294 -169  -97   56  182   72    0    0    0
      0    0]
  [   0    0  -55 -198 -294 -169  -42    3  206  128    0    0    0    0
      0    0]
  [   0  -55 -198 -294 -169  -42  101  107  141   72    0    0    0    0
      0    0]
  [   0 -153 -279 -169  -97   56  182   72    0    0    0  -55 -100 -115
   -115  -60]
  [ -55 -288 -225  -97  -42  191  128    0    0  -55 -100 -213 -204 -148
   -148    5]
  [-198 -294 -169  -42  101  197   17 -100 -115 -213 -204 -238 -169  -97
    -97  146]
  [-279 -169  -97   56  127  -28 -213 -204 -148 -238 -169  -97  -97  -97
    -97  146]
  [-210  -97  -97  146  -40 -189 -238 -169  -42    3   18   18   18  -37
    -82  146]
  [-210  -97  -97   91 -175 -225  -97  -42  101  107   51   51   -4 -147
   -153  146]
  [-165  -82  -97   -7 -166 -169  -97    1   82  -43 -115 -115 -213 -294
   -169  146]
  [-174 -138  -97  -97  -97  -97  -97   -7  -76 -148 -148 -148 -238 -114
      3  206]
  [-188 -110  -37  -82  -97  -97  -97  -97  -97  -97  -97  -42    3  116
    107  141]
  [ -90  -21  -47  -38   18   18   18   18   18   18   18  116  107  141
     72    0]]

 [[   0    0    0    5   19  -16 -119 -245 -245 -245 -186  -88   24    0
      0    0]
  [   0    0    0   91  137  132   43  -59  -59    0   98  119   49    0
      0    0]
  [   0    0    0    0  -59  -66 -132  -59    0   98  119   49    0    0
      0    0]
  [   0    0    0  -59 -157 -178 -108  -59   -5   -7   49    0    0    0
      0    0]
  [   0    0  -59 -157 -178 -108    0  103  133   73    0    0    0    0
      0    0]
  [   0  -59 -157 -178 -108    0   98  210   95   49    0    0    0    0
      0    0]
  [   0  -54  -52 -108  -59   -5   -7   49    0    0    0  -59 -162 -288
   -288 -229]
  [ -59  -66 -132  -59    0    7   73    0    0  -59 -162 -283 -269 -245
   -245 -191]
  [-157 -178 -108    0   98  119  -10 -162 -288 -283 -269 -154 -108  -59
    -59  -96]
  [ -52 -108  -59   -5  -66 -113 -283 -269 -245 -154 -108  -59  -59  -59
    -59  -96]
  [  -6  -59  -59  -96 -107 -143 -154 -108    0  103  229  229  229  170
     67  -96]
  [  -6  -59  -59 -155 -119 -132  -59    0   98  210  186  186  127   29
    -83  -96]
  [  97   67  -59 -150 -105 -108  -59  -64 -169 -239 -288 -288 -283 -178
   -108  -96]
  [  83   43  -59  -59  -59  -59  -59 -150 -196 -245 -245 -245 -154  -49
    103  133]
  [  96  156  170   67  -59  -59  -59  -59  -59  -59  -59    0  103  224
    210   95]
  [  91  137  191  205  229  229  229  229  229  229  229  224  210   95
     49    0]]

 [[   0    0    0   32  114   67  133   41   41   41  -17 -115 -105    0
      0    0]
  [   0    0    0   95  174  242  390  193  193  135   37  -48  -22    0
      0    0]
  [   0    0    0    0   58  251  320  193  135   37  -48  -22    0    0
      0    0]
  [   0    0    0   58  156  241  215  193  103 -140  -22    0    0    0
      0    0]
  [   0    0   58  156  241  215  135   69   34 -127    0    0    0    0
      0    0]
  [   0   58  156  241  215  135   37   47   57  -22    0    0    0    0
      0    0]
  [   0   90  333  215  193  103 -140  -22    0    0    0   58  124   32
     32  -26]
  [  58  251  320  193  135  -58 -127    0    0   58  124   64  146   41
     41  -49]
  [ 156  241  215  135   37  -48   36  124   32   64  146  136  215  193
    193    8]
  [ 333  215  193  103  -82  102   64  146   41  136  215  193  193  193
    193    8]
  [ 412  193  193    8 -129  238  136  215  135   69  161  161  161  219
    285    8]
  [ 412  193  193   66   32  320  193  135   37   47  152  152  210  308
    298    8]
  [ 346  285  193   98  114  215  193  161  -16   10   32   32   64  241
    215    8]
  [ 264  390  193  193  193  193  193   98   19   41   41   41  136  157
     69   34]
  [ 127  288  219  285  193  193  193  193  193  193  193  135   69  129
     47   57]
  [  95  174  184  266  161  161  161  161  161  161  161  129   47   57
    -22    0]]

 [[   0    0    0  -29  -35   59  143  229  229  229  184  129   49    0
      0    0]
  [   0    0    0 -128 -223 -219 -141   -6   -6  -51 -106  -58  -12    0
      0    0]
  [   0    0    0    0   45  -28  -43   -6  -51 -106  -58  -12    0    0
      0    0]
  [   0    0    0   45  100   52    6   -6  -22   28  -12    0    0    0
      0    0]
  [   0    0   45  100   52    6  -51 -135  -64   37    0    0    0    0
      0    0]
  [   0   45  100   52    6  -51 -106 -186 -107  -12    0    0    0    0
      0    0]
  [   0   16  -34    6   -6  -22   28  -12    0    0    0   45  129  215
    215  170]
  [  45  -28  -43   -6  -51   22   37    0    0   45  129  186  180  229
    229  213]
  [ 100   52    6  -51 -106  -58   33  129  215  186  180  101    6   -6
     -6  106]
  [ -34    6   -6  -22   73  117  186  180  229  101    6   -6   -6   -6
     -6  106]
  [-129   -6   -6  106  139   94  101    6  -51 -135 -221 -221 -221 -176
    -92  106]
  [-129   -6   -6  151   95  -43   -6  -51 -106 -186 -235 -235 -190 -135
    -55  106]
  [-213  -92   -6  122   89    6   -6   23  157  203  215  215  186   52
      6  106]
  [-207 -141   -6   -6   -6   -6   -6  122  217  229  229  229  101  -39
   -135  -64]
  [-157 -258 -176  -92   -6   -6   -6   -6   -6   -6   -6  -51 -135 -192
   -186 -107]
  [-128 -223 -264 -270 -221 -221 -221 -221 -221 -221 -221 -192 -186 -107
    -12    0]]]

After "x = relu_int(x)", x.shape = (4, 16, 16), x =
[[[  0   0   0   0   0   0   0   0   0   0   0  50  56   0   0   0]
  [  0   0   0   0   0   0   0   0   0   0 101 197  72   0   0   0]
  [  0   0   0   0   0   0   0   0   0 101 197  72   0   0   0   0]
  [  0   0   0   0   0   0   0   0  56 182  72   0   0   0   0   0]
  [  0   0   0   0   0   0   0   3 206 128   0   0   0   0   0   0]
  [  0   0   0   0   0   0 101 107 141  72   0   0   0   0   0   0]
  [  0   0   0   0   0  56 182  72   0   0   0   0   0   0   0   0]
  [  0   0   0   0   0 191 128   0   0   0   0   0   0   0   0   5]
  [  0   0   0   0 101 197  17   0   0   0   0   0   0   0   0 146]
  [  0   0   0  56 127   0   0   0   0   0   0   0   0   0   0 146]
  [  0   0   0 146   0   0   0   0   0   3  18  18  18   0   0 146]
  [  0   0   0  91   0   0   0   0 101 107  51  51   0   0   0 146]
  [  0   0   0   0   0   0   0   1  82   0   0   0   0   0   0 146]
  [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   3 206]
  [  0   0   0   0   0   0   0   0   0   0   0   0   3 116 107 141]
  [  0   0   0   0  18  18  18  18  18  18  18 116 107 141  72   0]]

 [[  0   0   0   5  19   0   0   0   0   0   0   0  24   0   0   0]
  [  0   0   0  91 137 132  43   0   0   0  98 119  49   0   0   0]
  [  0   0   0   0   0   0   0   0   0  98 119  49   0   0   0   0]
  [  0   0   0   0   0   0   0   0   0   0  49   0   0   0   0   0]
  [  0   0   0   0   0   0   0 103 133  73   0   0   0   0   0   0]
  [  0   0   0   0   0   0  98 210  95  49   0   0   0   0   0   0]
  [  0   0   0   0   0   0   0  49   0   0   0   0   0   0   0   0]
  [  0   0   0   0   0   7  73   0   0   0   0   0   0   0   0   0]
  [  0   0   0   0  98 119   0   0   0   0   0   0   0   0   0   0]
  [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
  [  0   0   0   0   0   0   0   0   0 103 229 229 229 170  67   0]
  [  0   0   0   0   0   0   0   0  98 210 186 186 127  29   0   0]
  [ 97  67   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
  [ 83  43   0   0   0   0   0   0   0   0   0   0   0   0 103 133]
  [ 96 156 170  67   0   0   0   0   0   0   0   0 103 224 210  95]
  [ 91 137 191 205 229 229 229 229 229 229 229 224 210  95  49   0]]

 [[  0   0   0  32 114  67 133  41  41  41   0   0   0   0   0   0]
  [  0   0   0  95 174 242 390 193 193 135  37   0   0   0   0   0]
  [  0   0   0   0  58 251 320 193 135  37   0   0   0   0   0   0]
  [  0   0   0  58 156 241 215 193 103   0   0   0   0   0   0   0]
  [  0   0  58 156 241 215 135  69  34   0   0   0   0   0   0   0]
  [  0  58 156 241 215 135  37  47  57   0   0   0   0   0   0   0]
  [  0  90 333 215 193 103   0   0   0   0   0  58 124  32  32   0]
  [ 58 251 320 193 135   0   0   0   0  58 124  64 146  41  41   0]
  [156 241 215 135  37   0  36 124  32  64 146 136 215 193 193   8]
  [333 215 193 103   0 102  64 146  41 136 215 193 193 193 193   8]
  [412 193 193   8   0 238 136 215 135  69 161 161 161 219 285   8]
  [412 193 193  66  32 320 193 135  37  47 152 152 210 308 298   8]
  [346 285 193  98 114 215 193 161   0  10  32  32  64 241 215   8]
  [264 390 193 193 193 193 193  98  19  41  41  41 136 157  69  34]
  [127 288 219 285 193 193 193 193 193 193 193 135  69 129  47  57]
  [ 95 174 184 266 161 161 161 161 161 161 161 129  47  57   0   0]]

 [[  0   0   0   0   0  59 143 229 229 229 184 129  49   0   0   0]
  [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
  [  0   0   0   0  45   0   0   0   0   0   0   0   0   0   0   0]
  [  0   0   0  45 100  52   6   0   0  28   0   0   0   0   0   0]
  [  0   0  45 100  52   6   0   0   0  37   0   0   0   0   0   0]
  [  0  45 100  52   6   0   0   0   0   0   0   0   0   0   0   0]
  [  0  16   0   6   0   0  28   0   0   0   0  45 129 215 215 170]
  [ 45   0   0   0   0  22  37   0   0  45 129 186 180 229 229 213]
  [100  52   6   0   0   0  33 129 215 186 180 101   6   0   0 106]
  [  0   6   0   0  73 117 186 180 229 101   6   0   0   0   0 106]
  [  0   0   0 106 139  94 101   6   0   0   0   0   0   0   0 106]
  [  0   0   0 151  95   0   0   0   0   0   0   0   0   0   0 106]
  [  0   0   0 122  89   6   0  23 157 203 215 215 186  52   6 106]
  [  0   0   0   0   0   0   0 122 217 229 229 229 101   0   0   0]
  [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
  [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]]]

After "x = maxpool_int(x, 2)", x.shape = (4, 8, 8), x =
[[[  0   0   0   0   0 197  72   0]
  [  0   0   0   0 182 197   0   0]
  [  0   0   0 107 206   0   0   0]
  [  0   0 191 182   0   0   0   5]
  [  0  56 197  17   0   0   0 146]
  [  0 146   0   0 107  51  18 146]
  [  0   0   0   1  82   0   0 206]
  [  0   0  18  18  18 116 141 141]]

 [[  0  91 137  43   0 119  49   0]
  [  0   0   0   0  98 119   0   0]
  [  0   0   0 210 133   0   0   0]
  [  0   0   7  73   0   0   0   0]
  [  0   0 119   0   0   0   0   0]
  [  0   0   0   0 210 229 229  67]
  [ 97   0   0   0   0   0   0 133]
  [156 205 229 229 229 229 224 210]]

 [[  0  95 242 390 193  37   0   0]
  [  0  58 251 320 135   0   0   0]
  [ 58 241 241 135  57   0   0   0]
  [251 333 193   0  58 124 146  41]
  [333 215 102 146 136 215 215 193]
  [412 193 320 215 135 161 308 298]
  [390 193 215 193  41  41 241 215]
  [288 285 193 193 193 193 129  57]]

 [[  0   0  59 229 229 184  49   0]
  [  0  45 100   6  28   0   0   0]
  [ 45 100  52   0  37   0   0   0]
  [ 45   6  22  37  45 186 229 229]
  [100   6 117 186 229 180   6 106]
  [  0 151 139 101   0   0   0 106]
  [  0 122  89 122 229 229 186 106]
  [  0   0   0   0   0   0   0   0]]]

After "x = conv2d_int(x, self.w2, pad=1)", x.shape = (5, 8, 8), x =
[[[  -1289   -3159   -9468  -16609  -13350   -7895  -12443   -4305]
  [   2049      23   -5425  -15043  -22161  -25370  -45329  -11143]
  [  -4485  -17057  -18791   -8310   -1881  -30771  -21556    -599]
  [ -13659  -16707  -13030  -13426  -22714  -31175  -10313   -4689]
  [ -14834  -14944   -8551  -35894  -32572   -9319  -24064  -29258]
  [ -11588  -23924  -26963  -42070  -24297  -29002  -24860  -14051]
  [  -5707  -11070  -33146   -6106      41  -11380   -8049   -8592]
  [  -4859   -7583  -15315  -11088  -12024  -33526  -24676  -15580]]

 [[   -263   -5292   -4434    1641   11479    3571    -307     244]
  [  -9973   -7167     717    8053    7278    8598    2890      49]
  [ -12960     329   20477   19673    3196   -6967  -11646   -6534]
  [  -6813   12150    9491    2246   -6501  -13993  -10115   -3010]
  [  -4426   10056    5264    3744   -4585  -18758  -14899     833]
  [  -1499   14947   -2477   -4701    -631   -6173   -2767    6426]
  [  -3801    7385    2126    1505    -272    6366    8259   10344]
  [  10962   13217   10176    4418    1269    1314   10302    9472]]

 [[  -4585   -6202    1783    9795   18430    3569  -17371   -4419]
  [ -23325  -49242  -66184  -22419  -54174  -75880  -44673   -6714]
  [ -11156  -19445  -21376  -40627  -81235  -60621  -12629      10]
  [ -23426   -9535  -38987  -94705  -62180  -16601     532    4282]
  [ -25462  -37481  -57944  -58182  -32542  -38273  -20206   -7923]
  [ -16093  -60555  -65898  -37198  -39696  -51896  -49483   -6925]
  [ -40597  -60149  -45427  -61244  -90213 -102355  -89963  -28275]
  [ -30945  -28482  -31631  -31849  -29418  -43140  -76587  -52748]]

 [[  -3847  -10263   -8105   -3174   -6961   -8871   -9456    -861]
  [  -5124   -1013    7442    7500    1689     -95    2986    1075]
  [  -6448   -1948   -7504   -5047   -3992   -2427    6866   15033]
  [  -6527   -1353   -7502   -3601    7159   10481    1781   -5242]
  [ -10226   -9313    -243    4736    2800   -8097   -5910   -3674]
  [  -8289   -6410   -1842   -2372   -2146     585    9578    9640]
  [  -3241   -2744   -2987   -1560    1894    1833    2666   -2118]
  [  -2841   -2614   -2560    1097    1135    1365    3840    4661]]

 [[   3868    4032  -23654  -53226  -63138  -43559  -42929  -11881]
  [  -5423  -24937  -43030  -46673  -51982  -61548  -28962   -1468]
  [  -5269  -35957  -60657  -71374  -69089  -56303  -38711  -41197]
  [ -10556  -62611  -53536  -91506  -74136  -49481  -63733  -52780]
  [ -25167  -99510  -84468  -70601  -40722  -29209  -42554  -39328]
  [ -28073  -77578  -76262  -65198  -63157  -82416  -92560  -81224]
  [ -26855  -48276  -40468  -37612  -40488  -45772  -60478  -48185]
  [ -12357  -25571  -40514  -36633  -25539  -34704  -74298  -53977]]]

After "x = relu_int(x)", x.shape = (5, 8, 8), x =
[[[    0     0     0     0     0     0     0     0]
  [ 2049    23     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0    41     0     0     0]
  [    0     0     0     0     0     0     0     0]]

 [[    0     0     0  1641 11479  3571     0   244]
  [    0     0   717  8053  7278  8598  2890    49]
  [    0   329 20477 19673  3196     0     0     0]
  [    0 12150  9491  2246     0     0     0     0]
  [    0 10056  5264  3744     0     0     0   833]
  [    0 14947     0     0     0     0     0  6426]
  [    0  7385  2126  1505     0  6366  8259 10344]
  [10962 13217 10176  4418  1269  1314 10302  9472]]

 [[    0     0  1783  9795 18430  3569     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0    10]
  [    0     0     0     0     0     0   532  4282]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]]

 [[    0     0     0     0     0     0     0     0]
  [    0     0  7442  7500  1689     0  2986  1075]
  [    0     0     0     0     0     0  6866 15033]
  [    0     0     0     0  7159 10481  1781     0]
  [    0     0     0  4736  2800     0     0     0]
  [    0     0     0     0     0   585  9578  9640]
  [    0     0     0     0  1894  1833  2666     0]
  [    0     0     0  1097  1135  1365  3840  4661]]

 [[ 3868  4032     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]
  [    0     0     0     0     0     0     0     0]]]

After "x = x>>9", x.shape = (5, 8, 8), x =
[[[ 0  0  0  0  0  0  0  0]
  [ 4  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]]

 [[ 0  0  0  3 22  6  0  0]
  [ 0  0  1 15 14 16  5  0]
  [ 0  0 39 38  6  0  0  0]
  [ 0 23 18  4  0  0  0  0]
  [ 0 19 10  7  0  0  0  1]
  [ 0 29  0  0  0  0  0 12]
  [ 0 14  4  2  0 12 16 20]
  [21 25 19  8  2  2 20 18]]

 [[ 0  0  3 19 35  6  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  1  8]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]]

 [[ 0  0  0  0  0  0  0  0]
  [ 0  0 14 14  3  0  5  2]
  [ 0  0  0  0  0  0 13 29]
  [ 0  0  0  0 13 20  3  0]
  [ 0  0  0  9  5  0  0  0]
  [ 0  0  0  0  0  1 18 18]
  [ 0  0  0  0  3  3  5  0]
  [ 0  0  0  2  2  2  7  9]]

 [[ 7  7  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]
  [ 0  0  0  0  0  0  0  0]]]

After "x = maxpool_int(x, 8)", x.shape = (5, 1, 1), x =
[[[ 4]]

 [[39]]

 [[35]]

 [[29]]

 [[ 7]]]

After "x = x.reshape(-1)", x.shape = (5,), x =
[ 4 39 35 29  7]

After "x = np.dot(self.w3.astype(np.int32)", x.shape = (10,), x =
[-2736 -3082 -2806 -3783 -2913 -3129 -1630 -4734 -2064 -4213]

After "x = x>>9", x.shape = (10,), x =
[ -6  -7  -6  -8  -6  -7  -4 -10  -5  -9]

predict number: 6
```
